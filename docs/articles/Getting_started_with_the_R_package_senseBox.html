<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting started with the R-package senseBox â€¢ senseBox</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google analytics --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-84499524-2', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">senseBox</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/Getting_started_with_the_R_package_senseBox.html">Getting Started with the R-package senseBox</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    news
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    functions
  </a>
</li>
<li>
  <a href="https://github.com/JohannesFriedrich/senseBox">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="Getting_started_with_the_R_package_senseBox_files/htmlwidgets-0.9/htmlwidgets.js"></script><script src="Getting_started_with_the_R_package_senseBox_files/jquery-1.12.4/jquery.min.js"></script><link href="Getting_started_with_the_R_package_senseBox_files/leaflet-0.7.7/leaflet.css" rel="stylesheet">
<script src="Getting_started_with_the_R_package_senseBox_files/leaflet-0.7.7/leaflet.js"></script><link href="Getting_started_with_the_R_package_senseBox_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<link href="Getting_started_with_the_R_package_senseBox_files/leaflet-label-0.2.2/leaflet.label.css" rel="stylesheet">
<script src="Getting_started_with_the_R_package_senseBox_files/leaflet-label-0.2.2/leaflet.label.js"></script><script src="Getting_started_with_the_R_package_senseBox_files/Proj4Leaflet-0.7.2/proj4-compressed.js"></script><script src="Getting_started_with_the_R_package_senseBox_files/Proj4Leaflet-0.7.2/proj4leaflet.js"></script><script src="Getting_started_with_the_R_package_senseBox_files/leaflet-binding-1.1.0.9000/leaflet.js"></script><script src="Getting_started_with_the_R_package_senseBox_files/leaflet-providers-1.0.27/leaflet-providers.js"></script><script src="Getting_started_with_the_R_package_senseBox_files/leaflet-providers-plugin-1.1.0.9000/leaflet-providers-plugin.js"></script><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Getting started with the R-package senseBox</h1>
                        <h4 class="author">Johannes Friedrich</h4>
            
            <h4 class="date">2017-12-21</h4>
          </div>

    
    
<div class="contents">
<div id="motivation" class="section level1">
<h1 class="hasAnchor">
<a href="#motivation" class="anchor"></a>Motivation</h1>
<p>The senseBox is a do-it-yourself kit for stationary and mobile sensor stations. With senseBox you can make measurements, helping to answer a variety of scientific questions and to support Citizen Science Projects from the local to global scale. Data collected by senseBox can increase the measured density of various enviromental factors and can contribute to more precise statements regarding climate, pollution or traffic.</p>
<p>openSenseMap is the platform for the publishing of senseBox and other open sensor data. Each senseBox transmits its measurements directly to the map, where anyone can observe, analyze and download the data.</p>
<p>This is the point where this <strong>R</strong>-pacakge comes into play: The <strong>R</strong>-package senseBox provides access to the senseBox API and enables the user to download, analyse and visualise the data provided by registered senseBoxes.</p>
<p>With pacakges like <code>ggplot2</code> or <code>plotly</code> <strong>R</strong> is the perfect tool to visualise data. In the next chapter you find a short introduction to the basic usage of this <strong>R</strong>-package and some examples how to visualise the data.</p>
</div>
<div id="usage" class="section level1">
<h1 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h1>
<p>First we show a little bit of senseBox statistics with the function <code><a href="../reference/get_senseBox_stats.html">get_senseBox_stats()</a></code>. Then we list all available senseBoxes with their Id and name. We choose an Id from a senseBox which is located in Berlin, Germany.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(senseBox)</code></pre></div>
<pre><code>## Loading required package: httr</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stats &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_senseBox_stats.html">get_senseBox_stats</a></span>()

list &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_senseBox_Ids.html">get_senseBox_Ids</a></span>()
senseBoxId &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"592ca4b851d3460011ea2635"</span>)</code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
variable
</th>
<th style="text-align:right;">
value
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Number of senseBoxes
</td>
<td style="text-align:right;">
1020
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of Measurements
</td>
<td style="text-align:right;">
491117755
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of measurements in last minute
</td>
<td style="text-align:right;">
1308
</td>
</tr>
</tbody>
</table>
<p>See where is the box located? We can easily get an overview and map the location. First we extract the coordinates of the senseBox. This can be done with <code><a href="../reference/get_senseBox_location.html">get_senseBox_location()</a></code>. Note that some extra packages are necessary to display the locations interactively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">location &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_senseBox_location.html">get_senseBox_location</a></span>(senseBoxId)

<span class="kw">library</span>(leaflet)
<span class="kw">library</span>(htmltools)

<span class="kw"><a href="http://www.rdocumentation.org/packages/leaflet/topics/leaflet">leaflet</a></span>(location) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/leaflet/topics/addProviderTiles">addProviderTiles</a></span>(providers<span class="op">$</span>OpenStreetMap) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/leaflet/topics/map-layers">addTiles</a></span>() <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/leaflet/topics/map-layers">addMarkers</a></span>(<span class="op">~</span>long, <span class="op">~</span>lat, <span class="dt">popup =</span> <span class="op">~</span>htmltools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/htmltools/topics/htmlEscape">htmlEscape</a></span>(name))</code></pre></div>
<div id="htmlwidget-f674486fd561f64f0b68" style="width:480px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-f674486fd561f64f0b68">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["OpenStreetMap",null,null,{"errorTileUrl":"","noWrap":false,"zIndex":null,"unloadInvisibleTiles":null,"updateWhenIdle":null,"detectRetina":false,"reuseTiles":false}]},{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"maxNativeZoom":null,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"continuousWorld":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":null,"unloadInvisibleTiles":null,"updateWhenIdle":null,"detectRetina":false,"reuseTiles":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addMarkers","args":[52.510952,13.392953,null,null,null,{"clickable":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},"Leipziger65-SÃ¼d",null,null,null,null,null,null]}],"limits":{"lat":[52.510952,52.510952],"lng":[13.392953,13.392953]}},"evals":[],"jsHooks":[]}</script><p>But now to the main part of the package: downloading and analysing data from senseBoxes.</p>
<ul>
<li>Get sensor Ids from a senseBox</li>
<li>Show some information about the sensor</li>
<li>Download the recorded data from the sensors</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sensor_info &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_senseBox_sensor_info.html">get_senseBox_sensor_info</a></span>(senseBoxId)

knitr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/knitr/topics/kable">kable</a></span>(
  sensor_info[[<span class="dv">1</span>]][,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],
  <span class="dt">format =</span> <span class="st">"html"</span>
)</code></pre></div>
<table class="table">
<thead><tr>
<th style="text-align:left;">
title
</th>
<th style="text-align:left;">
unit
</th>
<th style="text-align:left;">
sensorType
</th>
<th style="text-align:left;">
icon
</th>
<th style="text-align:left;">
_id
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
PM10
</td>
<td style="text-align:left;">
Âµg/mÂ³
</td>
<td style="text-align:left;">
SDS 011
</td>
<td style="text-align:left;">
osem-cloud
</td>
<td style="text-align:left;">
592ca4b851d3460011ea2636
</td>
</tr>
<tr>
<td style="text-align:left;">
PM2.5
</td>
<td style="text-align:left;">
Âµg/mÂ³
</td>
<td style="text-align:left;">
SDS 011
</td>
<td style="text-align:left;">
osem-cloud
</td>
<td style="text-align:left;">
592ca4b851d3460011ea2637
</td>
</tr>
<tr>
<td style="text-align:left;">
Temperatur
</td>
<td style="text-align:left;">
Â°C
</td>
<td style="text-align:left;">
DHT22
</td>
<td style="text-align:left;">
osem-thermometer
</td>
<td style="text-align:left;">
592ca4b851d3460011ea2638
</td>
</tr>
<tr>
<td style="text-align:left;">
rel. Luftfeuchte
</td>
<td style="text-align:left;">
%
</td>
<td style="text-align:left;">
DHT22
</td>
<td style="text-align:left;">
osem-humidity
</td>
<td style="text-align:left;">
592ca4b851d3460011ea2639
</td>
</tr>
</tbody>
</table>
<p>We can now download data from the senseBox, either from a specific sensorId or from all sensors within the sensBox. In the following we are downloading all available sensors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_all &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_senseBox_data.html">get_senseBox_data</a></span>(senseBoxId)</code></pre></div>
<p>When you are interested in just a selection of sensors, just submit the sensorIds to the function <code><a href="../reference/get_senseBox_data.html">get_senseBox_data()</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sensor_ids &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_senseBox_sensor_Ids.html">get_senseBox_sensor_Ids</a></span>(senseBoxId)

data_sel &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_senseBox_data.html">get_senseBox_data</a></span>(senseBoxId, 
                              <span class="dt">sensorId =</span> <span class="kw">list</span>(sensor_ids[[<span class="dv">1</span>]][<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]))</code></pre></div>
<p>When using the above code, by defatult, the data from the last 48 h will be downloaded. You can donwload up to 10,000 records and sepcify the date of the record. The maximum time frame for downloading data is back to one month from now. Use the argument <code>fromDate</code> and <code>toDate</code> to specify the desired time frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_timeframe &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_senseBox_data.html">get_senseBox_data</a></span>(senseBoxId, 
                                    sensor_ids, 
                                    <span class="dt">fromDate =</span> <span class="st">"2017-11-11 11:11:11"</span>, 
                                    <span class="dt">toDate =</span> <span class="st">"2017-11-12 11:11:11"</span>)</code></pre></div>
<p>Visualising the results from all sensors is one of the main aims and we recommend using the <strong>R</strong>-package <code>ggplot2</code>. We provide a sample code next and you just have to change the data executed in the function <code><a href="http://www.rdocumentation.org/packages/reshape2/topics/melt">melt()</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(reshape2)
<span class="kw">library</span>(scales)


data_melt &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/reshape2/topics/melt">melt</a></span>(data_timeframe[[<span class="dv">1</span>]], <span class="dt">id.vars =</span> <span class="kw">c</span>(<span class="st">"createdAt"</span>, <span class="st">"value"</span>))

<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(data_melt, <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> createdAt, <span class="dt">y =</span> value, <span class="dt">colour =</span> L1)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/scale_date">scale_x_datetime</a></span>(<span class="dt">labels =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/scales/topics/date_format">date_format</a></span>(<span class="st">"%H:%M"</span>, <span class="dt">tz =</span> <span class="kw">Sys.timezone</span>())) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/facet_wrap">facet_wrap</a></span>(<span class="op">~</span>L1, <span class="dt">scales =</span> <span class="st">"free"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>,
        <span class="dt">legend.title =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/element">element_blank</a></span>())</code></pre></div>
<p><img src="Getting_started_with_the_R_package_senseBox_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#motivation">Motivation</a></li>
      <li><a href="#usage">Usage</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Johannes Friedrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
